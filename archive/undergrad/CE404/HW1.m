clear ; close all ; clc ;
% element4 = readmatrix( 'Truss4element.txt' ) ;
% element8 = readmatrix( 'Truss8element.txt' ) ;
% element16 = readmatrix( 'Truss16element.txt' ) ;
% element32 = readmatrix( 'Truss32element.txt' ) ;

element4 = [0,4.84375000000000e-32;2.51211000000000,0.0121094000000000;5.02266000000000,0.0226563000000000;7.53008000000000,0.0300781000000000;10.0328000000000,0.0328125000000000;0,500000000;2.51211000000000,468750000;5.02266000000000,375000000;7.53008000000000,218750000;10.0328000000000,-4] ;
element8 = [0,4.96090000000000e-32;1.25620000000000,0.00620117000000000;2.51221000000000,0.0122070000000000;3.76782000000000,0.0178223000000000;5.02285000000000,0.0228516000000000;6.27710000000000,0.0270996000000000;7.53037000000000,0.0303711000000000;8.78247000000000,0.0324707000000000;10.0332000000000,0.0332031000000000;0,500000000;1.25620000000000,492187000;2.51221000000000,468750000;3.76782000000000,429688000;5.02285000000000,375000000;6.27710000000000,304688000;7.53037000000000,218750000;8.78247000000000,117187000;10.0332000000000,-2];
element16 = [0,4.99023000000000e-32;0.628119000000000,0.00311890000000000;1.25621000000000,0.00621338000000000;1.88426000000000,0.00925900000000000;2.51223000000000,0.0122314000000000;3.14011000000000,0.0151062000000000;3.76786000000000,0.0178589000000000;4.39546000000000,0.0204651000000000;5.02290000000000,0.0229004000000000;5.65014000000000,0.0251404000000000;6.27716000000000,0.0271606000000000;6.90394000000000,0.0289368000000000;7.53044000000000,0.0304443000000000;8.15666000000000,0.0316589000000000;8.78256000000000,0.0325562000000000;9.40811000000000,0.0331116000000000;10.0333000000000,0.0333008000000000;0,500000000;0.628119000000000,498047000;1.25621000000000,492188000;1.88426000000000,482422000;2.51223000000000,468750000;3.14011000000000,451172000;3.76786000000000,429687000;4.39546000000000,404297000;5.02290000000000,375000000;5.65014000000000,341797000;6.27716000000000,304688000;6.90394000000000,263672000;7.53044000000000,218750000;8.15666000000000,169922000;8.78256000000000,117187000;9.40811000000000,60546900;10.0333000000000,-1] ;
element32 = [0,4.99756000000000e-32;0.314062000000000,0.00156174000000000;0.628120000000000,0.00312042000000000;0.942173000000000,0.00467300000000000;1.25622000000000,0.00621643000000000;1.57025000000000,0.00774765000000000;1.88426000000000,0.00926361000000000;2.19826000000000,0.0107613000000000;2.51224000000000,0.0122375000000000;2.82619000000000,0.0136894000000000;3.14011000000000,0.0151138000000000;3.45401000000000,0.0165077000000000;3.76787000000000,0.0178680000000000;4.08169000000000,0.0191917000000000;4.39548000000000,0.0204758000000000;4.70922000000000,0.0217171000000000;5.02291000000000,0.0229126000000000;5.33656000000000,0.0240593000000000;5.65015000000000,0.0251541000000000;5.96369000000000,0.0261940000000000;6.27718000000000,0.0271759000000000;6.59060000000000,0.0280968000000000;6.90395000000000,0.0289536000000000;7.21724000000000,0.0297432000000000;7.53046000000000,0.0304626000000000;7.84361000000000,0.0311089000000000;8.15668000000000,0.0316788000000000;8.46967000000000,0.0321693000000000;8.78258000000000,0.0325775000000000;9.09540000000000,0.0329002000000000;9.40813000000000,0.0331345000000000;9.72078000000000,0.0332771000000000;10.0333000000000,0.0333252000000000;0,500000000;0.314062000000000,499512000;0.628120000000000,498047000;0.942173000000000,495605000;1.25622000000000,492187000;1.57025000000000,487793000;1.88426000000000,482422000;2.19826000000000,476074000;2.51224000000000,468750000;2.82619000000000,460449000;3.14011000000000,451172000;3.45401000000000,440918000;3.76787000000000,429688000;4.08169000000000,417480000;4.39548000000000,404297000;4.70922000000000,390137000;5.02291000000000,375000000;5.33656000000000,358887000;5.65015000000000,341797000;5.96369000000000,323730000;6.27718000000000,304688000;6.59060000000000,284668000;6.90395000000000,263672000;7.21724000000000,241699000;7.53046000000000,218750000;7.84361000000000,194824000;8.15668000000000,169922000;8.46967000000000,144043000;8.78258000000000,117187000;9.09540000000000,89355500;9.40813000000000,60546900;9.72078000000000,30761700;10.0333000000000,0.500000000000000] ;

x4 = element4(1:(end/2),1) ;
d4 = element4(1:end/2,2)*1e3 ;
s4 = element4((end/2+1):end,2)*1e-6 ;

x8 = element8(1:end/2,1) ;
d8 = element8(1:end/2,2)*1e3 ;
s8 = element8((end/2+1):end,2)*1e-6 ;

x16 = element16(1:end/2,1) ;
d16 = element16(1:end/2,2)*1e3 ;
s16 = element16((end/2+1):end,2)*1e-6 ;

x32 = element32(1:end/2,1) ;
d32 = element32(1:end/2,2)*1e3 ;
s32 = element32((end/2+1):end,2)*1e-6 ;

element = [ 4 , 8 , 16 , 32 ]' ;
tip_disp = [ d4(end) , d8(end) , d16(end) , d32(end) ]' ;
f_0 = [ s4(1) , s8(1) , s16(1) , s32(1) ]' ;
f_h = [ s4(ceil(end/2)) , s8(ceil(end/2)) , s16(ceil(end/2)) , s32(ceil(end/2)) ]' ;
f_L = [ s4(end) , s8(end) , s16(end) , s32(end) ]' ;
d_0 = [ d4(1) , d8(1) , d16(1) , d32(1) ]' ;
d_h = [ d4(ceil(end/2)) , d8(ceil(end/2)) , d16(ceil(end/2)) , d32(ceil(end/2)) ]' ;
d_L = [ d4(end) , d8(end) , d16(end) , d32(end) ]' ;
columnNames = { 'Elements' , 'At_Support' , 'Half_Length' , 'Full_Length' } ;
DispTab = table( element , d_0 , d_h , d_L ) ;
StressTab = table( element , f_0 , f_h , f_L ) ;
DispTab.Properties.VariableNames = columnNames ;
StressTab.Properties.VariableNames = columnNames ;
disp( 'Displacement [mm]' )
disp( DispTab )
disp( 'Stress [MPa]' )
disp( StressTab )

figure
plot( x4 , d4 , x8 , d8 , x16 , d16 , x32 , d32 )
xlabel( 'X Position [m]' )
ylabel( 'Displacement [mm]' )
legend( '4 Elements' , '8' , '16' , '32' , 'Location' , 'southeast' )

figure
plot( x4 , s4 , x8 , s8 , x16 , s16 , x32 , s32 )
xlabel( 'X Position [m]' )
ylabel( 'Stress [MPa]' )
legend( '4 Elements' , '8' , '16' , '32' )

figure
plot( element , tip_disp )
xlabel( 'Number of Elements' )
ylabel( 'Tip Displacement [mm]' )

figure
subplot( 3 , 1 , 1 )
plot( element , f_0 )
% xlabel( 'Number of Elements' )
ylabel( 'Stress [MPa]' )
title( 'At support' )

subplot( 3 , 1 , 2 )
plot( element , f_h )
% xlabel( 'Number of Elements' )
ylabel( 'Stress [MPa]' )
title( 'Half Length' )

subplot( 3 , 1 , 3 )
plot( element , f_L )
xlabel( 'Number of Elements' )
ylabel( 'Stress [MPa]' )
title( 'Full Length' )

figure
subplot( 3 , 1 , 1 )
plot( element , d_0 )
% xlabel( 'Number of Elements' )
ylabel( 'Displacement [mm]' )
title( 'At support' )

subplot( 3 , 1 , 2 )
plot( element , d_h )
% xlabel( 'Number of Elements' )
ylabel( 'Displacement [mm]' )
title( 'Half Length' )

subplot( 3 , 1 , 3 )
plot( element , d_L )
xlabel( 'Number of Elements' )
ylabel( 'Displacement [mm]' )
title( 'Full Length' )