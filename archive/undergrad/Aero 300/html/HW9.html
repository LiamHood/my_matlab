
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>HW9</title><meta name="generator" content="MATLAB 9.3"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2018-06-06"><meta name="DC.source" content="HW9.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">HW 9</a></li><li><a href="#2">12.1.4</a></li><li><a href="#3">12.2.5a</a></li><li><a href="#4">12.3</a></li><li><a href="#5">Functions</a></li></ul></div><h2 id="1">HW 9</h2><p>Liam Hood</p><pre class="codeinput">clear
close <span class="string">all</span>
</pre><h2 id="2">12.1.4</h2><pre class="codeinput">a = [ 10 -12 -6 ; 5 -5 -4 ; -1 0 3 ] ;
b = [ -14 20 10 ; -19 27 12 ; 23 -32 -13 ] ;
c = [ 8 -8 -4 ; 12 -15 -7 ; -18 26 12 ] ;
d = [ 12 -4 -2 ; 19 -19 -10 ; -35 52 27 ] ;
iteration = 10 ;
guess = [ .8 .4 .4 ]'  ;
[ veca , lama ] = rqi( a , guess , iteration ) ;
[ vecb , lamb ] = rqi( b , guess , iteration ) ;
[ vecc , lamc ] = rqi( c , guess , iteration ) ;
[ vecd , lamd ] = rqi( d , guess , iteration ) ;
guess = [ -.5 -.5 .5 ]' ;
[ veca2 , lama2 ] = rqi( a , guess , iteration ) ;
[ vecb2 , lamb2 ] = rqi( b , guess , iteration ) ;
[ vecc2 , lamc2 ] = rqi( c , guess , iteration ) ;
[ vecd2 , lamd2 ] = rqi( d , guess , iteration ) ;
guess = [ 0 .45 -.9 ]' ;
[ veca3 , lama3 ] = rqi( a , guess , iteration ) ;
[ vecb3 , lamb3 ] = rqi( b , guess , iteration ) ;
[ vecc3 , lamc3 ] = rqi( c , guess , iteration ) ;
[ vecd3 , lamd3 ] = rqi( d , guess , iteration ) ;
</pre><h2 id="3">12.2.5a</h2><pre class="codeinput">A = [ 4 3 1 ; -5 -3 0 ; 3 2 1 ] ;
[ Qbar , lam ] = qr_eigen( A , iteration )
</pre><pre class="codeoutput">
Qbar =

    0.5770    0.4088    0.7071
   -0.5775   -0.4080    0.7071
    0.5775   -0.8164    0.0007


lam =

    1.9967
    0.5003
   -0.4971

</pre><h2 id="4">12.3</h2><pre class="codeinput">A2 = [ 0 1 ; 1 1.5 ] ;
[ v , lam1 ] = eig(A2) ;
s = abs(lam1) ;
<span class="keyword">for</span> ii = 1:length(A2)
    <span class="keyword">if</span> lam1(ii,ii) &gt;= 1
        u(:,ii) = v(:,ii) ;
    <span class="keyword">else</span>
        u(:,ii) = -v(:,ii) ;
    <span class="keyword">end</span>
<span class="keyword">end</span>
disp( <span class="string">'U'</span> )
disp( u )
disp( <span class="string">'S'</span> )
disp( s )
disp( <span class="string">'V'</span> )
disp( v )
</pre><pre class="codeoutput">U
    0.8944    0.4472
   -0.4472    0.8944

S
    0.5000         0
         0    2.0000

V
   -0.8944    0.4472
    0.4472    0.8944

</pre><h2 id="5">Functions</h2><pre class="codeinput"><span class="keyword">function</span> [ vec , lam ]=rqi( A , guess , iteration )
    x = guess ;
    <span class="keyword">for</span> j = 1:iteration
        u = x/norm(x) ;                <span class="comment">% normalize</span>
        lam = u'*A*u ;                 <span class="comment">% Rayleigh quotient</span>
        x = (A-lam*eye(size(A)))\u ;   <span class="comment">% inverse power iteration</span>
        x = x/norm(x) ;
    <span class="keyword">end</span>
    vec = x/norm(x) ;
    lam = u'*A*u ;                     <span class="comment">% Rayleigh quotient</span>
<span class="keyword">end</span>

<span class="keyword">function</span> [ Qbar , lam ] = qr_eigen( A , iterations )
<span class="comment">%Input A of any size and iteration count. Outputs eigenvectors in Qbar and</span>
<span class="comment">%corresponding eigenvalues in lam</span>
    [ height , width ] = size(A) ;
    Q = eye( height , height ) ; <span class="comment">%Create initial guess of Q</span>
    Qbar = Q ; <span class="comment">%Begin Qbar</span>
    R = A ; <span class="comment">%Starting R value</span>
    <span class="keyword">for</span> jj = 1:iterations <span class="comment">%Continues for a given number of iterations</span>
        [ Q , R ] = qr( R*Q ) ; <span class="comment">%Find new Q and R</span>
        Qbar = Qbar*Q ; <span class="comment">%Find new Qbar</span>
    <span class="keyword">end</span>
    lam = diag( R*Q ) ; <span class="comment">%find eigenvalues</span>

<span class="keyword">end</span>
</pre><pre class="codeoutput">Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  4.111937e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  4.625929e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  4.625929e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.541976e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  4.625929e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.541976e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  4.625929e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.541976e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  4.625929e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.541976e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  7.116814e-19. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  4.811585e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.779204e-19. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.609792e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.090729e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.482927e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.609792e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.090729e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.482927e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.609792e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.034031e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.541976e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.541976e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.541976e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.541976e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.541976e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.541976e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.541976e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.541976e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.541976e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  8.657096e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  7.082864e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  8.657096e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  7.082864e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  8.657096e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  7.082864e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  8.657096e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  7.082864e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  8.657096e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  7.082864e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  2.114711e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  2.114711e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  7.049035e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.409807e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  2.114711e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  3.348292e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.409807e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  2.114711e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  3.348292e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.409807e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.081726e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.783491e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  6.319761e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  7.172735e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.081726e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.783491e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  6.319761e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  7.172735e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.081726e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.783491e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  5.120525e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.086172e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.086172e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.086172e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.086172e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.086172e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.086172e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.086172e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.086172e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.086172e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  2.351061e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  5.125063e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  5.013108e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  4.602605e-19. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  3.395976e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.604692e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  2.351061e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  5.125063e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  5.013108e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  4.602605e-19. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.004487e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  2.960595e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  6.344132e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.621278e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.004487e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  4.405647e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  5.286776e-19. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  5.286776e-19. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  5.286776e-19. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  5.286776e-19. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  4.573001e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  4.573001e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  4.573001e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  4.573001e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  4.573001e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  4.573001e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  4.573001e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  4.573001e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  4.573001e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  4.573001e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.002285e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  5.396917e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  3.083953e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.002285e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  6.424902e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  3.083953e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.002285e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  5.396917e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  3.083953e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.002285e-17. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  2.226011e-19. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  5.416627e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  2.226011e-19. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  9.349247e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  5.416627e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  2.226011e-19. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  9.349247e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  5.416627e-18. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  2.226011e-19. 
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  9.349247e-18. 
</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2017b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% HW 9
% Liam Hood
clear
close all

%% 12.1.4
a = [ 10 -12 -6 ; 5 -5 -4 ; -1 0 3 ] ;
b = [ -14 20 10 ; -19 27 12 ; 23 -32 -13 ] ;
c = [ 8 -8 -4 ; 12 -15 -7 ; -18 26 12 ] ;
d = [ 12 -4 -2 ; 19 -19 -10 ; -35 52 27 ] ;
iteration = 10 ;
guess = [ .8 .4 .4 ]'  ;
[ veca , lama ] = rqi( a , guess , iteration ) ;
[ vecb , lamb ] = rqi( b , guess , iteration ) ;
[ vecc , lamc ] = rqi( c , guess , iteration ) ;
[ vecd , lamd ] = rqi( d , guess , iteration ) ;
guess = [ -.5 -.5 .5 ]' ;
[ veca2 , lama2 ] = rqi( a , guess , iteration ) ;
[ vecb2 , lamb2 ] = rqi( b , guess , iteration ) ;
[ vecc2 , lamc2 ] = rqi( c , guess , iteration ) ;
[ vecd2 , lamd2 ] = rqi( d , guess , iteration ) ;
guess = [ 0 .45 -.9 ]' ;
[ veca3 , lama3 ] = rqi( a , guess , iteration ) ;
[ vecb3 , lamb3 ] = rqi( b , guess , iteration ) ;
[ vecc3 , lamc3 ] = rqi( c , guess , iteration ) ;
[ vecd3 , lamd3 ] = rqi( d , guess , iteration ) ;
%% 12.2.5a
A = [ 4 3 1 ; -5 -3 0 ; 3 2 1 ] ;
[ Qbar , lam ] = qr_eigen( A , iteration ) 

%% 12.3
A2 = [ 0 1 ; 1 1.5 ] ;
[ v , lam1 ] = eig(A2) ;
s = abs(lam1) ;
for ii = 1:length(A2)
    if lam1(ii,ii) >= 1 
        u(:,ii) = v(:,ii) ;
    else
        u(:,ii) = -v(:,ii) ;
    end
end
disp( 'U' )
disp( u )
disp( 'S' )
disp( s )
disp( 'V' )
disp( v )
%% Functions
function [ vec , lam ]=rqi( A , guess , iteration )
    x = guess ;
    for j = 1:iteration
        u = x/norm(x) ;                % normalize
        lam = u'*A*u ;                 % Rayleigh quotient
        x = (A-lam*eye(size(A)))\u ;   % inverse power iteration
        x = x/norm(x) ;
    end
    vec = x/norm(x) ;
    lam = u'*A*u ;                     % Rayleigh quotient
end

function [ Qbar , lam ] = qr_eigen( A , iterations )
%Input A of any size and iteration count. Outputs eigenvectors in Qbar and
%corresponding eigenvalues in lam
    [ height , width ] = size(A) ;
    Q = eye( height , height ) ; %Create initial guess of Q
    Qbar = Q ; %Begin Qbar
    R = A ; %Starting R value
    for jj = 1:iterations %Continues for a given number of iterations
        [ Q , R ] = qr( R*Q ) ; %Find new Q and R
        Qbar = Qbar*Q ; %Find new Qbar
    end
    lam = diag( R*Q ) ; %find eigenvalues

end

##### SOURCE END #####
--></body></html>